!include pyversions.yaml
!include rcic-package.yaml
---
- package: Python Programming Language 
  name: python 
  release: "{{pyversion.release}}"
  version: "{{python_version}}"
  family_version: "{{python_family}}"
  major_version: "{{python_major}}"
  extension: tgz
  src_dir: "Python-{{version}}"
  src_tarball: "{{src_dir}}.{{extension}}"
  pkgname: "{{name}}_{{version}}"
  vendor_source: https://www.python.org/ftp/python/{{version}}/Python-{{version}}.tgz
  description: >
    Python version {{version}}
  build:
    configure_args: --enable-shared --enable-optimizations --enable-ipv6 {{unique_opts}}
    modules: 
    target: 
  install:
    makeinstall: $(MAKE) DESTDIR=$(ROOT) altinstall 
    installextra: >
      $(INSTALL) -m 644  README* $(ROOT)/{{root}};
      cd $(ROOT)/{{root}}/bin;
      ln -s python{{family_version}} python;
      ln -s python{{family_version}} python{{major_version}};
      ln -s python{{family_version}}-config python-config;
      ln -s python{{family_version}}-config python{{major_version}}-config
  rpm:
    extras:
      - "AutoReqProv: no\\nProvides: libpython{{family_version}}m.so.1.0()(64bit)"
      - "%define _python_bytecompile_errors_terminate_build 0"
      - "%define __python %{buildroot}/$(PKGROOT)/bin/python{{major_version}}"
      - | 
        %define __spec_install_post \
        %{?__debug_package:%{__debug_install_post}}\
        export LD_LIBRARY_PATH=%{buildroot}/$(PKGROOT)/lib:$$LD_LIBRARY_PATH;\
        %{__arch_install_post}\
        %{__os_install_post}\
        %{nil} 
